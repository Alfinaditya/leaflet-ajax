L.GeoJSON.AJAX=L.GeoJSON.extend({defaultAJAXparams:{dataType:"json",callbackParam:"callback"},initialize:function(e,t){this._url=e;var a=L.Util.extend({},this.defaultAJAXparams);for(var s in t){if(this.defaultAJAXparams.hasOwnProperty(s)){a[s]=t[s]}}this.ajaxParams=a;this._layers={};L.Util.setOptions(this,t);if(this._url){this.addUrl(this._url)}},addUrl:function(e){var t=this;t._url=e;if(this.ajaxParams.dataType.toLowerCase()==="json"){L.Util.ajax(e,function(e){t._cache=e;t.addData(e)})}else if(this.ajaxParams.dataType.toLowerCase()==="jsonp"){L.Util.jsonp(e,function(e){t._cache=e;t.addData(e)},t.ajaxParams.callbackParam)}},refresh:function(e){e=e||this._url;this.clearLayers();this.addUrl(e)},refilter:function(e){if(typeof e!=="function"){e=function(){return true}}this.clearLayers();this.addData(this._cache.features.filter(e))}});L.geoJson.ajax=function(e,t){return new L.GeoJSON.AJAX(e,t)};L.Util.ajax=function(url,cb){if(window.XMLHttpRequest===undefined){window.XMLHttpRequest=function(){try{return new ActiveXObject("Microsoft.XMLHTTP.6.0")}catch(e){try{return new ActiveXObject("Microsoft.XMLHTTP.3.0")}catch(t){throw new Error("XMLHttpRequest is not supported")}}}}var response,request=new XMLHttpRequest;request.open("GET",url);request.onreadystatechange=function(){if(request.readyState===4&&request.status===200){if(window.JSON){response=JSON.parse(request.responseText)}else{response=eval("("+request.responseText+")")}cb(response)}};request.send()};L.Util.jsonp=function(e,t,a,s){var r,i,n,o,c=document.getElementsByTagName("head")[0];var a=a||"callback";if(s){r=s}else{n="_"+(""+Math.random()).slice(2);r="L.Util.jsonp.cb."+n}o=L.DomUtil.create("script","",c);o.type="text/javascript";if(n){L.Util.jsonp.cb[n]=function(e){c.removeChild(o);delete L.Util.jsonp.cb[n];t(e)}}if(e.indexOf("?")===-1){i=e+"?"+a+"="+r}else{i=e+"&"+a+"="+r}o.src=i};L.Util.jsonp.cb={};